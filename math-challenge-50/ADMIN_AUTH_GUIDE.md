# 管理者認証機能の実装ガイド

## 実装内容

### 1. 管理者専用認証ページ (`/admin/auth`)

管理者・教員専用の認証ページを作成しました。

**機能:**
- ✅ ログイン
- ✅ 新規登録（管理者メールアドレスのみ）
- ✅ パスワードリセット

**管理者メールアドレス:**
- `mitamuraka@haguroko.ed.jp` (三田村和真)
- `katoyu@haguroko.ed.jp` (加藤勇太朗)

### 2. 生徒用認証ページ (`/auth`)

生徒用の認証ページを更新しました。

**変更点:**
- ✅ ログイン機能は維持
- ✅ 新規登録は無効化（管理者に連絡するよう案内）
- ✅ 管理者メールアドレスでの登録を拒否

### 3. ランディングページ (`/`)

**追加:**
- ✅ 管理者・教員用のボタンを追加

## 使い方

### 管理者・教員の方

1. **初回登録（パスワード未設定の場合）**
   - ランディングページから「管理者・教員の方はこちら」をクリック
   - `/admin/auth`にアクセス
   - 「新規登録はこちら」をクリック
   - 管理者メールアドレスと名前、パスワードを入力
   - 登録完了後、ログイン

2. **ログイン**
   - `/admin/auth`にアクセス
   - メールアドレスとパスワードを入力
   - ログイン後、自動的に管理画面 (`/admin`) にリダイレクト

3. **パスワードリセット**
   - `/admin/auth`でログイン画面を表示
   - 管理者メールアドレスを入力
   - 「パスワードを忘れた場合」をクリック
   - メールボックスを確認してパスワードリセット

### 生徒の方

1. **ログイン**
   - ランディングページから「冒険を始める」をクリック
   - `/auth`にアクセス
   - メールアドレスとパスワードを入力してログイン

2. **新規登録**
   - 生徒の新規登録は管理者がCSVファイルで一括登録します
   - 登録が必要な場合は、先生にご連絡ください

## GitHubへのプッシュ

### クイックコマンド

```powershell
cd "C:\Users\PC_User\Desktop\アプリ\math-challenge-50\Master-Portfolio-DB"; git add .; git commit -m "Add: 管理者専用認証ページの実装"; git push origin main
```

### PowerShellスクリプトを使用

```powershell
cd "C:\Users\PC_User\Desktop\アプリ\math-challenge-50\Master-Portfolio-DB\math-challenge-50"
.\PUSH_ADMIN_AUTH.ps1
```

### ステップバイステップ

```powershell
# 1. プロジェクトディレクトリに移動
cd "C:\Users\PC_User\Desktop\アプリ\math-challenge-50\Master-Portfolio-DB"

# 2. 変更をステージング
git add .

# 3. コミット
git commit -m "Add: 管理者専用認証ページの実装 - 生徒登録の制限"

# 4. GitHubにプッシュ
git push origin main
```

## デプロイ後の確認

1. **管理者認証ページ**
   - `/admin/auth`にアクセス
   - 管理者メールアドレスで登録・ログインができるか確認

2. **生徒認証ページ**
   - `/auth`にアクセス
   - 管理者メールアドレスでの登録が拒否されるか確認

3. **ランディングページ**
   - `/`にアクセス
   - 管理者用ボタンが表示されるか確認

## トラブルシューティング

### 管理者メールアドレスで登録できない

- メールアドレスが正確に入力されているか確認
- 大文字小文字は区別されませんが、スペースがないか確認

### パスワードリセットメールが届かない

- メールボックスの迷惑メールフォルダを確認
- Supabaseのメール設定を確認
- メールアドレスが正しいか確認

### ログインできない

- メールアドレスとパスワードが正しいか確認
- 管理者メールアドレスで登録済みか確認
- ブラウザのキャッシュをクリアして再試行
